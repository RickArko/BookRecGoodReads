# Book Recommender Streamlit Apps

This directory contains two Streamlit applications for the book recommendation system.

## Apps

### 1. Basic App (`app.py`)
Simple KNN collaborative filtering interface.

**Features:**
- Basic book search
- KNN-based recommendations
- Simple filters (rating, year)
- Clean UI

**Run:**
```bash
streamlit run app/app.py
```

### 2. Enhanced App (`app_enhanced.py`) ⭐ **RECOMMENDED**
Advanced hybrid recommender with full features.

**Features:**
- **Hybrid Recommender**: Combines collaborative + content-based filtering
- **Tunable Weights**: Adjust collaborative/content balance with sliders
- **Better Search**: Improved fuzzy matching with ranked results
- **Multiple Methods**: Choose between Hybrid, Collaborative Only, or Content Only
- **Rich Visualizations**:
  - Score breakdown charts
  - Genre distribution
  - Metrics dashboard
- **Evaluation Metrics**:
  - Diversity score
  - Coverage metrics
  - Score distributions
- **Advanced Filters**: Rating and publication year filters
- **Detailed Book Info**: Authors, genres, ratings, pages

**Run:**
```bash
streamlit run app/app_enhanced.py
```

Or use the provided scripts:
```bash
# Windows
run_app.bat

# Linux/Mac
./run_app.sh
```

## Requirements

The enhanced app requires additional dependencies:

```bash
uv add streamlit plotly
```

Or if using pip:
```bash
pip install streamlit plotly polars fuzzywuzzy
```

## Data Files Required

Both apps need these data files (generated by `prepare_data.py`):

**Basic App:**
- `data/book_user_matrix_sparse.npz`
- `data/sparse_matrix_book_mapping.parquet`
- `data/sparse_matrix_user_mapping.parquet`
- `data/filtered_titles.parquet`

**Enhanced App (additional):**
- `data/content_features.npz`
- `data/book_metadata.parquet`

## Generating Data

If you haven't generated the data files yet:

```bash
# 1. Generate interaction matrix
python prepare_data.py --min_reads=10 --top_books=50000 --top_users=1000000

# 2. Extract metadata
python extract_metadata.py

# 3. Create content features
python create_content_features.py
```

## Usage Tips

### Enhanced App

1. **Adjust Hybrid Weights**:
   - Higher collaborative weight (e.g., 0.7) → More focus on user interaction data
   - Higher content weight (e.g., 0.7) → More focus on book features (genres, authors)
   - Balanced (0.5/0.5) → Equal importance to both

2. **Choose Method**:
   - **Hybrid**: Best overall, combines strengths of both approaches
   - **Collaborative Only**: Good for popular books with many ratings
   - **Content Only**: Good for books with sparse interaction data

3. **Use Filters**:
   - Filter by minimum rating to get only highly-rated books
   - Filter by year range for books from specific periods

4. **Explore Analytics**:
   - Check the "Analytics" tab for genre distribution
   - View "Metrics" tab for diversity and coverage scores

## Performance

- **Initial Load**: 4-6 seconds (cached after first load)
- **Recommendation Speed**: ~0.1-0.5 seconds per query
- **Memory Usage**: ~500MB for 50K books

## Screenshots

### Main Search Interface
![Search](screenshots/search.png)

### Recommendations with Details
![Recommendations](screenshots/recommendations.png)

### Analytics Dashboard
![Analytics](screenshots/analytics.png)

## Troubleshooting

**Error: "Failed to load recommender"**
- Make sure you've run all data preparation scripts
- Check that data files exist in the `data/` directory

**Slow Performance**
- The first load will be slow as it initializes models
- Subsequent loads use Streamlit's caching and are much faster
- Consider using a smaller dataset for faster loading

**No Matches Found**
- Lower the "Search threshold" slider in settings
- Try different search terms
- Use the autocomplete dropdown

## Development

To modify the apps:

1. Edit the respective `.py` file
2. Streamlit will auto-reload on save
3. If you modify the hybrid_recommender.py, restart the app

## License

MIT License - feel free to modify and extend!
